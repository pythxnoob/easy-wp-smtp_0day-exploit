# This is scanner for 0-Day vulnerability in
# "Easy-WP-SMTP" plugin that allows reset admin 
# password for web-site with this plugin

##        PLEASE STAR THAT REPOSITORY        ##
import sys, time, random
import requests as req
from colorama import init, Fore, Style

init()



print(f'''
{Fore.GREEN}╔═══╦═══╦═══╦╗  ╔╗{Fore.WHITE}╔╗╔╗╔╦═══╗{Fore.LIGHTRED_EX}╔═══╦═╗╔═╦════╦═══╗
{Fore.GREEN}║╔══╣╔═╗║╔═╗║╚╗╔╝║{Fore.WHITE}║║║║║║╔═╗║{Fore.LIGHTRED_EX}║╔═╗║║╚╝║║╔╗╔╗║╔═╗║
{Fore.GREEN}║╚══╣║ ║║╚══╬╗╚╝╔╝{Fore.WHITE}║║║║║║╚═╝║{Fore.LIGHTRED_EX}║╚══╣╔╗╔╗╠╝║║╚╣╚═╝║
{Fore.GREEN}║╔══╣╚═╝╠══╗║╚╗╔╝ {Fore.WHITE}║╚╝╚╝║╔══╝{Fore.LIGHTRED_EX}╚══╗║║║║║║ ║║ ║╔══╝
{Fore.GREEN}║╚══╣╔═╗║╚═╝║ ║║  {Fore.WHITE}╚╗╔╗╔╣║   {Fore.LIGHTRED_EX}║╚═╝║║║║║║ ║║ ║║
{Fore.GREEN}╚═══╩╝ ╚╩═══╝ ╚╝  {Fore.WHITE} ╚╝╚╝╚╝   {Fore.LIGHTRED_EX}╚═══╩╝╚╝╚╝ ╚╝ ╚╝

{Fore.WHITE}              ╔═══╦═══╗
{Fore.WHITE}              ║╔═╗╠╗╔╗║
{Fore.WHITE}              ║║║║║║║║╠══╦╗ ╔╗
{Fore.WHITE}              ║║║║║║║║║╔╗║║ ║║
{Fore.WHITE}              ║╚═╝╠╝╚╝║╔╗║╚═╝║
{Fore.WHITE}              ╚═══╩═══╩╝╚╩═╗╔╝
{Fore.WHITE}           	         ╔═╝║
{Fore.WHITE}                         ╚══╝
               	    scanner

''')

if len(sys.argv) < 2:
	exit(Fore.RED+f'Usage: python3 {sys.argv[0]} site.domain (without http/https)')

vulner   = '_debug_log.txt'

class URL:
	HTTP = 'http://'
	Site = sys.argv[1]
	Evil = '/wp-content/plugins/easy-wp-smtp'

trueURL  = URL.HTTP+URL.Site+URL.Evil

Checking = req.get(trueURL)

print(f'{Style.RESET_ALL}[{Fore.BLUE}*{Style.RESET_ALL}] - Trying to access {trueURL}\n\n'),time.sleep(1.5)
if Checking.status_code == 200:
	if vulner in str(Checking.content):
		print(f'{Style.RESET_ALL}[{Fore.GREEN}+{Style.RESET_ALL}] - Target is vulnerable!')
	else:
		print(f"{Style.RESET_ALL}[{Fore.RED}-{Style.RESET_ALL}] - Target isn't vulnerable!")
else:
	print(f"{Style.RESET_ALL}[{Fore.RED}-{Style.RESET_ALL}] - Target isn't vulnerable!")